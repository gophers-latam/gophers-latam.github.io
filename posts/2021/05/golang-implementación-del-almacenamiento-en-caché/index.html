<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="ZeroIdentidad"><meta name=description content="Gophers LATAM"><title>Golang: Implementaci√≥n del almacenamiento en cach√© ‚Äì Gophers LATAM</title><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/css/style.min.a84a5066e61beb36e290156b73d729ef98cd9fde56d916842cc892df1bdb478f.css><link rel=stylesheet href=/css/syntax.min.f1fef9cbbfe9d2935981821d59853e89db60d137f9117a1279371320195f1d1a.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-192145152-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7766642915413571" crossorigin=anonymous></script></head><body><div class=container><header class="page-header app-width"><div class=header-left><a href=/><img alt="Gophers LATAM" src=/img/gopher.png></a></div><div class=header-center><nav><a href=/>Inicio</a>
<a href=/acerca>Acerca</a>
<a href=/proyectos>Proyectos</a>
<a href=/posts>Posts</a>
<a href=/colaboradores>Colaboradores</a>
<a href=/contacto>Contacto</a></nav></div><div class=header-right><a class=button-search href=/search>üîç</a></div></header><main class=app-width><article class=post><header><h2>Golang: Implementaci√≥n del almacenamiento en cach√©</h2><span class=tags><a class=tag href=/tags/librerias>librerias</a>
<a class=tag href=/tags/golang>golang</a></span>
<span class=meta><label>Por: <b>ZeroIdentidad</b></label>
<label>Publicado <b>May 6, 2021</b></label>
<label>Tiempo de lectura: <b>4 minutos</b>.</label></span></header><section class=body><figure class=post-figure><a href=/posts/2021/05/golang-implementaci%C3%B3n-del-almacenamiento-en-cach%C3%A9/images/go-cache.jpg><img src=/posts/2021/05/golang-implementaci%C3%B3n-del-almacenamiento-en-cach%C3%A9/images/go-cache_huddfdaf20a9de86793c7e04ee08a1b995_15138_1024x0_resize_q75_box.jpg width=1024 height=465 alt="go cache"></a><figcaption>go cache</figcaption></figure><p>El almacenamiento en cach√© de datos en una aplicaci√≥n web a veces es necesario para evitar solicitar datos est√°ticos de una base de datos o un servicio externo una y otra vez. Go no proporciona ning√∫n paquete integrado en la librer√≠a est√°ndar para almacenar en cach√© las respuestas, pero lo admite a trav√©s de paquetes externos creados por la comunidad.</p><p>Hay una serie de paquetes, como <a href=https://github.com/coocood/freecache><strong>github.com/coocood/freecache</strong></a>,¬†<a href=https://github.com/patrickmn/go-cache><strong>github.com/patrickmn/go-cache</strong></a>, <a href=https://github.com/eko/gocache><strong>github.com/eko/gocache</strong></a> y <a href=https://github.com/etcd-io/etcd><strong>github.com/etcd-io/etcd</strong></a> (gRPC) que pueden ayudar a implementar el almacenamiento en cach√©. Por parte de la comunidad de <strong>Gophers LATAM</strong> se busca crear algo relacionado: <a href=https://github.com/gophers-latam/GoKey><strong>github.com/gophers-latam/GoKey</strong></a></p><p>Para este post se estar√° usando <strong>github.com/patrickmn/go-cache</strong> para implementar un ejemplo de uso.</p><h3 id=ejemplo>Ejemplo:</h3><p>Primero crear un directorio para el c√≥digo fuente de prueba e inicializar un go module. [<em>go mod init cache-example</em>]</p><p>Luego crear archivo <strong>.go</strong>, donde se har√° un cach√© por medio de la librer√≠a y se completar√° con datos sobre el arranque del servidor, de la siguiente manera:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

<span style=color:#f92672>import</span> (
	<span style=color:#e6db74>&#34;fmt&#34;</span>
	<span style=color:#e6db74>&#34;log&#34;</span>
	<span style=color:#e6db74>&#34;net/http&#34;</span>
	<span style=color:#e6db74>&#34;time&#34;</span>

	<span style=color:#e6db74>&#34;github.com/patrickmn/go-cache&#34;</span>
)

<span style=color:#66d9ef>const</span> (
	<span style=color:#a6e22e>CONN_PORT</span> = <span style=color:#e6db74>&#34;8080&#34;</span>
)

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>newCache</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>Cache</span>

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>init</span>() {
	<span style=color:#a6e22e>newCache</span> = <span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>New</span>(<span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Minute</span>, <span style=color:#ae81ff>10</span><span style=color:#f92672>*</span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Minute</span>)
	<span style=color:#a6e22e>newCache</span>.<span style=color:#a6e22e>Set</span>(<span style=color:#e6db74>&#34;gophers&#34;</span>, <span style=color:#e6db74>&#34;gophers latam&#34;</span>, <span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>DefaultExpiration</span>)
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getFromCache</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
	<span style=color:#a6e22e>gophers</span>, <span style=color:#a6e22e>found</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>newCache</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#e6db74>&#34;gophers&#34;</span>)

	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>found</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Print</span>(<span style=color:#e6db74>&#34;Key encontrada en cach√© con valor, como : &#34;</span>, <span style=color:#a6e22e>gophers</span>.(<span style=color:#66d9ef>string</span>))
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Hola &#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>gophers</span>.(<span style=color:#66d9ef>string</span>))
	} <span style=color:#66d9ef>else</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Print</span>(<span style=color:#e6db74>&#34;Key no encontrada en cach√© : &#34;</span>, <span style=color:#e6db74>&#34;gophers&#34;</span>)
		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Key no encontrada en cach√©&#34;</span>)
	}
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>getFromCache</span>)

	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#e6db74>&#34;:&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>CONN_PORT</span>, <span style=color:#66d9ef>nil</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#e6db74>&#34;error al iniciar el servidor http : &#34;</span>, <span style=color:#a6e22e>err</span>)
		<span style=color:#66d9ef>return</span>
	}
}
</code></pre></div><ul><li>Ejecutar el c√≥digo.</li></ul><h3 id=como-funciona>Como funciona:</h3><p>Una vez iniciado, el servidor HTTP comenzar√° a escuchar localmente en el puerto 8080. Al inicio, la clave con el nombre <strong>gophers</strong> con un valor como <strong>gophers latam</strong> se agregar√° a la cach√©.</p><p>Al navegar por <em>http://localhost:8080/</em> se leer√° un valor de key de la cach√© y lo agregar√° a <em>Hola</em> como se muestra en la siguiente captura de pantalla:</p><p><img src=images/captura.png alt=captura1></p><p>Log en terminal:</p><p><img src=images/captura_1.png alt=captura2></p><p>Se ha especificado el tiempo de caducidad de los datos de la cach√© en el programa como 5 minutos, lo que significa que la clave que se ha creado en la cach√© al iniciar el servidor no estar√° all√≠ despu√©s de 5 minutos. Por lo tanto, acceder a la misma URL nuevamente despu√©s de 5 minutos devolver√° que la clave no es encontrada en la cach√© del servidor, de la siguiente manera:</p><p><img src=images/captura_3.png alt=captura3></p><p><img src=images/captura_2.png alt=captura4></p><p>Usando <strong>var newCache</strong> *<strong>cache.Cache</strong>, se declara una cach√© privada.</p><p>Se actualiza la funci√≥n <strong>init()</strong> donde se crea un cach√© con 5 minutos de tiempo de vencimiento y 10 minutos de intervalo de limpieza, y se agrega un elemento a cach√© con una clave como <strong>gophers</strong> con su valor como <strong>gophers latam</strong> y su valor de vencimiento como <strong>0</strong>, lo que significa que se quiere usar el tiempo de vencimiento predeterminado de la cach√©.</p><p>Para usarse se define el controlador <strong>getFromCache</strong> donde se recupera el valor de una clave en cach√©. Si se encuentra, se escribe en respuesta HTTP, de lo contrario, se escribe el mensaje <em>Key no encontrada en cach√©</em>.</p></section><section class=related><h3>Relacionados</h3><div class=post-list><article class="box box-post"><a class=title href=/posts/2021/04/golang-referencia-esencial-go-modules/><h3>Golang: Referencia esencial Go modules</h3></a><time class=date>April
30</time><div class=summary-container><figure class=post-figure><a href=/posts/2021/04/golang-referencia-esencial-go-modules/images/go-modules.png><img src=/posts/2021/04/golang-referencia-esencial-go-modules/images/go-modules_hu4efca11e3cf5c24922ed10c2ec6d81f7_540656_1024x0_resize_box_2.png width=1024 height=642 alt="Go Modules"></a><figcaption>Go Modules</figcaption></figure><p>Esta es una hoja de trucos esenciales, no una referencia oficial. Con el fin de que sea conciso, se omitieron aspectos menos frecuentes, dado que este sitio desde su <a href=https://github.com/gophers-latam/gophers-latam.github.io>repositorio</a> esta abierto a cambios de contribuidores en la comunidad de <strong>Gophers LATAM</strong> cualquiera puede hacer cambios que mejoren este contenido.</p></div></article><article class="box box-post"><a class=title href=/posts/2021/04/golang-mantener-actualizado-el-sdk/><h3>Golang: Mantener actualizado el SDK</h3></a><time class=date>April
12</time><div class=summary-container><figure class=post-figure><a href=/posts/2021/04/golang-mantener-actualizado-el-sdk/images/update-go.png><img src=/posts/2021/04/golang-mantener-actualizado-el-sdk/images/update-go_hu6b1249bbbab4c5cd87135a176f9a4910_40986_1024x0_resize_box_2.png width=1024 height=584 alt="Update Go"></a><figcaption>Update Go</figcaption></figure><p>Como ocurre con todos los lenguajes de programaci√≥n, hay actualizaciones peri√≥dicas de las herramientas de desarrollo de Go. El SDK Go son binarios nativos que no dependen de un tiempo de ejecuci√≥n independiente, por lo que no hay que preocuparse de que la actualizaci√≥n del entorno de desarrollo pueda hacer que los programas actualmente implementados fallen. Puede tenerse programas compilados con diferentes versiones de Go ejecut√°ndose simult√°neamente en la misma computadora o m√°quina virtual.</p></div></article><article class="box box-post"><a class=title href=/posts/2021/04/golang-resumen-reglas/><h3>Golang: Resumen reglas</h3></a><time class=date>April
10</time><div class=summary-container><figure class=post-figure><a href=/posts/2021/04/golang-resumen-reglas/images/go-police.png><img src=/posts/2021/04/golang-resumen-reglas/images/go-police_hue7d7c6d1a137cc488db438363aa4cc3d_46281_1024x0_resize_box_2.png width=1024 height=696 alt="Go Police"></a><figcaption>Go Police</figcaption></figure><p>El lenguaje de programaci√≥n Go fue creado para hacer el trabajo f√°cilmente.</p><p>Go tiene conceptos similares a los lenguajes imperativos y el tipado est√°tico. Tambi√©n es r√°pido en la compilaci√≥n, r√°pido de ejecutar e implementar. Grande y complejo.</p></div></article><article class="box box-post"><a class=title href=/posts/2021/05/golang-init-func/><h3>Golang: Init func</h3></a><time class=date>May
5</time><div class=summary-container><figure class=post-figure><a href=/posts/2021/05/golang-init-func/images/init_func_go.png><img src=/posts/2021/05/golang-init-func/images/init_func_go_huce4b74cbd5109a0f59896119f92a02eb_68253_1024x0_resize_box_2.png width=1024 height=427 alt="init func"></a><figcaption>init func</figcaption></figure><p>Cada programa en Go debe tener un paquete <strong>main</strong> con una funci√≥n <strong>main</strong> para ser ejecutado. Sin embargo, esto impone algunas limitaciones para determinadas soluciones, como las librer√≠as. Imagina que importamos una librer√≠a a nuestro c√≥digo.</p></div></article><article class="box box-post"><a class=title href=/posts/2021/04/golang-la-interfaz-vac%C3%ADa/><h3>Golang: La interfaz vac√≠a</h3></a><time class=date>April
22</time><div class=summary-container><figure class=post-figure><a href=/posts/2021/04/golang-la-interfaz-vac%C3%ADa/images/interface-type.png><img src=/posts/2021/04/golang-la-interfaz-vac%C3%ADa/images/interface-type_hu3507cf0943d8ccceef7ea63d0a620d0a_94824_1024x0_resize_box_2.png width=1024 height=639 alt="Interface type"></a><figcaption>Interface type</figcaption></figure><p>Explicaci√≥n breve sobre el tipo interfaz vacia y nula.</p><p>Se define una interfaz vac√≠a como <strong>interface{}</strong>, y puede contener un valor de cualquier tipo:</p></div></article></div></section><section class=comments><h3>Comentar</h3><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"gophers-latam"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></article></main><footer><a href=https://gohugo.io><img src=/img/hugo-logo.svg width=90 height=21></a>
<small>¬© 2021, Gophers LATAM. - Theme by Zero.</small></footer></div></body></html>